# NoteDraw æŠ€æœ¯æ¶æ„æ–‡æ¡£

## ä¸€ã€æŠ€æœ¯æ ˆæ¦‚è§ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ |
|------|----------|------|
| æ¡†æ¶ | Next.js (App Router) | 15.2.6 |
| è¯­è¨€ | TypeScript | 5.8.3 |
| UIåº“ | React | 19.0.0 |
| CSS | Tailwind CSS | 4.0.14 |
| æ•°æ®åº“ | PostgreSQL + Drizzle ORM | 0.39.3 |
| è®¤è¯ | Better Auth | 1.1.19 |
| æ”¯ä»˜ | Stripe / Creem | - |
| é‚®ä»¶ | Resend | 6.4.2 |
| AI SDK | Vercel AI SDK | 5.0.0 |
| çŠ¶æ€ç®¡ç† | Zustand | 5.0.3 |
| è¡¨å•éªŒè¯ | Zod | 4.0.17 |
| åŠ¨ç”» | Motion (Framer Motion) | 12.4.3 |

---

## äºŒã€é¡¹ç›®ç›®å½•ç»“æ„

```
mksaas-template-main/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ actions/           # Server Actions
â”‚   â”‚   â”œâ”€â”€ notedraw.ts    # æ ¸å¿ƒä¸šåŠ¡Actions
â”‚   â”‚   â”œâ”€â”€ plaza.ts       # å¹¿åœºActions
â”‚   â”‚   â”œâ”€â”€ redemption.ts  # å…‘æ¢ç Actions
â”‚   â”‚   â””â”€â”€ ...            # å…¶ä»–Actions
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                # AIç›¸å…³æ¨¡å—
â”‚   â”‚   â””â”€â”€ notedraw/      # è§†è§‰ç¬”è®°AI
â”‚   â”‚       â”œâ”€â”€ index.ts       # ä¸»æµç¨‹
â”‚   â”‚       â”œâ”€â”€ organizer.ts   # æ‹†è§£Agent
â”‚   â”‚       â”œâ”€â”€ designer.ts    # Promptæ„å»º
â”‚   â”‚       â”œâ”€â”€ painter.ts     # ç”Ÿå›¾Agent
â”‚   â”‚       â”œâ”€â”€ prompts.ts     # æç¤ºè¯
â”‚   â”‚       â”œâ”€â”€ styles.ts      # é£æ ¼é…ç½®
â”‚   â”‚       â””â”€â”€ types.ts       # ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ app/               # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ [locale]/      # å›½é™…åŒ–è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ (marketing)/   # è¥é”€é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ (protected)/   # éœ€ç™»å½•é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ admin/     # ç®¡ç†åå°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/ # ç”¨æˆ·ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ notedraw/  # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ settings/  # è®¾ç½®é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ (auth)/        # è®¤è¯é¡µé¢
â”‚   â”‚   â””â”€â”€ api/           # APIè·¯ç”±
â”‚   â”‚       â”œâ”€â”€ auth/          # è®¤è¯API
â”‚   â”‚       â””â”€â”€ webhooks/      # Webhookå¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ components/        # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ admin/         # ç®¡ç†åå°ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ auth/          # è®¤è¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ notedraw/      # æ ¸å¿ƒä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ui/            # åŸºç¡€UIç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ website.tsx    # ç½‘ç«™é…ç½®
â”‚   â”‚   â””â”€â”€ notedraw.ts    # ä¸šåŠ¡é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ credits/           # ç§¯åˆ†ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ credits.ts     # ç§¯åˆ†æ“ä½œ
â”‚   â”‚   â””â”€â”€ types.ts       # ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                # æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ index.ts       # è¿æ¥ç®¡ç†
â”‚   â”‚   â””â”€â”€ schema.ts      # è¡¨å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ i18n/              # å›½é™…åŒ–
â”‚   â”‚   â”œâ”€â”€ messages/      # ç¿»è¯‘æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ routing.ts     # è·¯ç”±é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/               # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ auth.ts        # è®¤è¯é…ç½®
â”‚   â”‚   â”œâ”€â”€ safe-action.ts # Server ActionåŒ…è£…
â”‚   â”‚   â””â”€â”€ utils.ts       # é€šç”¨å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ mail/              # é‚®ä»¶
â”‚   â”‚   â”œâ”€â”€ index.ts       # é‚®ä»¶å‘é€
â”‚   â”‚   â””â”€â”€ templates/     # é‚®ä»¶æ¨¡æ¿
â”‚   â”‚
â”‚   â”œâ”€â”€ payment/           # æ”¯ä»˜
â”‚   â”‚   â”œâ”€â”€ index.ts       # æ”¯ä»˜å…¥å£
â”‚   â”‚   â”œâ”€â”€ stripe/        # Stripeå®ç°
â”‚   â”‚   â””â”€â”€ creem/         # Creemå®ç°
â”‚   â”‚
â”‚   â””â”€â”€ types/             # å…¨å±€ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ content/               # å†…å®¹ï¼ˆåšå®¢/æ–‡æ¡£ï¼‰
â”œâ”€â”€ public/                # é™æ€èµ„æº
â”œâ”€â”€ drizzle.config.ts      # Drizzleé…ç½®
â”œâ”€â”€ next.config.ts         # Next.jsé…ç½®
â””â”€â”€ tailwind.config.ts     # Tailwindé…ç½®
```

---

## ä¸‰ã€è®¤è¯ç³»ç»Ÿï¼ˆBetter Authï¼‰

### 3.1 è®¤è¯æ–¹å¼

| æ–¹å¼ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| é‚®ç®±å¯†ç  | å¯ç”¨ | é»˜è®¤ç™»å½•æ–¹å¼ |
| Google OAuth | å¯é€‰ | éœ€é…ç½®Client ID/Secret |
| GitHub OAuth | å¯é€‰ | éœ€é…ç½®Client ID/Secret |

### 3.2 æ ¸å¿ƒé…ç½®

```typescript
// src/lib/auth.ts
export const auth = betterAuth({
  baseURL: getBaseUrl(),
  appName: 'NoteDraw',
  database: drizzleAdapter(getDbSync(), { provider: 'pg' }),

  session: {
    cookieCache: { enabled: true, maxAge: 3600 },
    expiresIn: 60 * 60 * 24 * 7,    // 7å¤©
    updateAge: 60 * 60 * 24,        // æ¯å¤©æ›´æ–°
    freshAge: 0,                     // ç¦ç”¨æ–°é²œåº¦
  },

  emailAndPassword: {
    enabled: true,
    requireEmailVerification: true,
  },

  socialProviders: {
    github: { clientId, clientSecret },
    google: { clientId, clientSecret },
  },

  account: {
    accountLinking: {
      enabled: true,
      trustedProviders: ['google', 'github'],
    },
  },

  user: {
    additionalFields: { customerId: { type: 'string', required: false } },
    deleteUser: { enabled: true },
  },

  plugins: [
    admin({
      defaultBanExpiresIn: undefined,
      bannedUserMessage: 'You have been banned...',
    }),
  ],
});
```

### 3.3 è®¤è¯Hook

```typescript
// ç”¨æˆ·åˆ›å»ºåæ‰§è¡Œ
databaseHooks: {
  user: {
    create: {
      after: async (user) => {
        // 1. è‡ªåŠ¨è®¢é˜…Newsletter
        // 2. æ·»åŠ æ³¨å†Œèµ é€ç§¯åˆ†
        // 3. æ·»åŠ å…è´¹è®¡åˆ’æœˆåº¦ç§¯åˆ†
      },
    },
  },
},
```

### 3.4 ä¼šè¯ç®¡ç†

```typescript
// è·å–å½“å‰ç”¨æˆ·ä¼šè¯
import { getSession } from '@/lib/server';
const session = await getSession();
// session.user åŒ…å«ç”¨æˆ·ä¿¡æ¯
```

### 3.5 æƒé™æ§åˆ¶

```typescript
// ç®¡ç†å‘˜æƒé™æ£€æŸ¥
if (session.user.role !== 'admin') {
  notFound();
}

// Actionæƒé™åŒ…è£…
export const userActionClient = createSafeActionClient()
  .use(authMiddleware);  // éœ€ç™»å½•

export const adminActionClient = createSafeActionClient()
  .use(authMiddleware)
  .use(adminMiddleware); // éœ€ç®¡ç†å‘˜
```

---

## å››ã€æ”¯ä»˜ç³»ç»Ÿ

### 4.1 æ”¯ä»˜æä¾›å•†

| æä¾›å•† | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| Stripe | æ”¯æŒ | å›½é™…ä¸»æµ |
| Creem | é»˜è®¤ | æ–°å…´æ”¯ä»˜ |

### 4.2 æ”¯ä»˜ç±»å‹

```typescript
enum PaymentTypes {
  SUBSCRIPTION = 'subscription',  // è®¢é˜…
  ONE_TIME = 'one_time',          // ä¸€æ¬¡æ€§
}

enum PlanIntervals {
  MONTH = 'month',
  QUARTER = 'quarter',
  YEAR = 'year',
}
```

### 4.3 æ”¯ä»˜æµç¨‹

```
1. ç”¨æˆ·é€‰æ‹©è®¡åˆ’
    â†“
2. createCheckoutSession â†’ åˆ›å»ºæ”¯ä»˜ä¼šè¯
    â†“
3. è·³è½¬åˆ° Stripe/Creem æ”¯ä»˜é¡µé¢
    â†“
4. æ”¯ä»˜å®Œæˆ
    â†“
5. Webhook å›è°ƒ
    â†“
6. handleWebhookEvent â†’ æ›´æ–°æ•°æ®åº“
    - åˆ›å»º/æ›´æ–° payment è®°å½•
    - æ·»åŠ ç§¯åˆ†
    - æ›´æ–°ç”¨æˆ· customerId
```

### 4.4 Webhookå¤„ç†

```typescript
// src/app/api/webhooks/creem/route.ts
export async function POST(req: NextRequest) {
  const payload = await req.text();
  const signature = req.headers.get('x-creem-signature');
  await handleWebhookEvent(payload, signature);
  return NextResponse.json({ received: true });
}
```

### 4.5 ç§¯åˆ†åŒ…è´­ä¹°

```typescript
// æ”¯ä»˜åœºæ™¯
type PaymentScene = 'subscription' | 'lifetime' | 'credit';

// ç§¯åˆ†åŒ…æ”¯ä»˜å
if (scene === 'credit') {
  await addCredits({
    userId,
    amount: package.amount,
    type: 'credit_pack',
    expireDays: package.expireDays,
  });
}
```

---

## äº”ã€æ•°æ®åº“ç³»ç»Ÿ

### 5.1 è¿æ¥ç®¡ç†

```typescript
// src/db/index.ts
import { drizzle } from 'drizzle-orm/postgres-js';
import postgres from 'postgres';

const queryClient = postgres(process.env.DATABASE_URL!);
export const db = drizzle(queryClient);

// å¼‚æ­¥è·å–ï¼ˆæ¨èï¼‰
export async function getDb() {
  return db;
}

// åŒæ­¥è·å–ï¼ˆBetter Authä¸“ç”¨ï¼‰
export function getDbSync() {
  return db;
}
```

### 5.2 Schemaå®šä¹‰

ä½¿ç”¨Drizzle ORMå®šä¹‰è¡¨ç»“æ„ï¼Œè§ [03-æ•°æ®æ¨¡å‹.md](./03-æ•°æ®æ¨¡å‹.md)

### 5.3 è¿ç§»å‘½ä»¤

```bash
pnpm db:generate   # ç”Ÿæˆè¿ç§»æ–‡ä»¶
pnpm db:migrate    # æ‰§è¡Œè¿ç§»
pnpm db:push       # ç›´æ¥æ¨é€ï¼ˆå¼€å‘ç”¨ï¼‰
pnpm db:studio     # æ‰“å¼€Studio
```

---

## å…­ã€é‚®ä»¶ç³»ç»Ÿ

### 6.1 æœåŠ¡å•†

ä½¿ç”¨ Resend å‘é€é‚®ä»¶

### 6.2 é‚®ä»¶æ¨¡æ¿

ä½¿ç”¨ React Email å®šä¹‰æ¨¡æ¿

```
src/mail/templates/
â”œâ”€â”€ verify-email.tsx       # é‚®ç®±éªŒè¯
â”œâ”€â”€ forgot-password.tsx    # å¿˜è®°å¯†ç 
â””â”€â”€ welcome.tsx            # æ¬¢è¿é‚®ä»¶
```

### 6.3 å‘é€é‚®ä»¶

```typescript
import { sendEmail } from '@/mail';

await sendEmail({
  to: user.email,
  template: 'verifyEmail',
  context: { url, name: user.name },
  locale: 'zh',
});
```

---

## ä¸ƒã€å­˜å‚¨ç³»ç»Ÿ

### 7.1 S3å…¼å®¹å­˜å‚¨

æ”¯æŒä»»ä½•S3å…¼å®¹çš„å­˜å‚¨æœåŠ¡ï¼ˆAWS S3ã€Cloudflare R2ã€Minioç­‰ï¼‰

### 7.2 é…ç½®

```typescript
storage: {
  enable: true,
  provider: 's3',
},
```

### 7.3 ç¯å¢ƒå˜é‡

```bash
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_BUCKET_NAME=
S3_ENDPOINT=
S3_PUBLIC_URL=
```

---

## å…«ã€å›½é™…åŒ–ç³»ç»Ÿ

### 8.1 æ”¯æŒè¯­è¨€

| ä»£ç  | è¯­è¨€ | æ ‡å¿— |
|------|------|------|
| en | English | ğŸ‡ºğŸ‡¸ |
| zh | ä¸­æ–‡ | ğŸ‡¨ğŸ‡³ |

### 8.2 è·¯ç”±ç»“æ„

```
/en/dashboard    â†’ è‹±æ–‡ä»ªè¡¨ç›˜
/zh/dashboard    â†’ ä¸­æ–‡ä»ªè¡¨ç›˜
/notedraw        â†’ æ ¹æ®Cookie/æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨é‡å®šå‘
```

### 8.3 ä½¿ç”¨æ–¹å¼

```typescript
// æœåŠ¡ç«¯ç»„ä»¶
import { getTranslations } from 'next-intl/server';
const t = await getTranslations('Dashboard');
t('title');

// å®¢æˆ·ç«¯ç»„ä»¶
import { useTranslations } from 'next-intl';
const t = useTranslations('Dashboard');
```

### 8.4 ç¿»è¯‘æ–‡ä»¶

```
src/i18n/messages/
â”œâ”€â”€ en.json
â””â”€â”€ zh.json
```

---

## ä¹ã€åšå®¢ç³»ç»Ÿ

### 9.1 æŠ€æœ¯æ–¹æ¡ˆ

ä½¿ç”¨ Fumadocs å®ç° MDX åšå®¢

### 9.2 ç›®å½•ç»“æ„

```
content/
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ en/                # è‹±æ–‡æ–‡ç« 
â”‚   â”‚   â””â”€â”€ hello.mdx
â”‚   â””â”€â”€ zh/                # ä¸­æ–‡æ–‡ç« 
â”‚       â””â”€â”€ hello.mdx
â””â”€â”€ docs/                  # æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
```

### 9.3 æ–‡ç« æ ¼å¼

```mdx
---
title: æ–‡ç« æ ‡é¢˜
description: æ–‡ç« æè¿°
date: 2024-01-01
author: ä½œè€…å
tags: [tag1, tag2]
---

æ–‡ç« å†…å®¹...
```

### 9.4 é…ç½®

```typescript
blog: {
  enable: true,
  paginationSize: 6,
  relatedPostsSize: 3,
},
```

---

## åã€AI SDKé›†æˆ

### 10.1 æ”¯æŒçš„Provider

| Provider | SDK | ç”¨é€” |
|----------|-----|------|
| OpenAI | @ai-sdk/openai | æ–‡æœ¬/å›¾åƒ |
| Google | @ai-sdk/google | æ–‡æœ¬/å›¾åƒ |
| Deepseek | @ai-sdk/deepseek | æ–‡æœ¬ |
| Replicate | @ai-sdk/replicate | å›¾åƒ |
| FAL | @ai-sdk/fal | å›¾åƒ |
| Fireworks | @ai-sdk/fireworks | æ–‡æœ¬ |
| OpenRouter | @openrouter/ai-sdk-provider | å¤šæ¨¡å‹ |

### 10.2 ä½¿ç”¨æ–¹å¼

```typescript
import { generateText } from 'ai';
import { openai } from '@ai-sdk/openai';

const { text } = await generateText({
  model: openai('gpt-4o'),
  prompt: 'Hello, world!',
});
```

---

## åä¸€ã€UIç»„ä»¶ç³»ç»Ÿ

### 11.1 ç»„ä»¶åº“

åŸºäº Radix UI + Tailwind CSS æ„å»º

### 11.2 ç»„ä»¶åˆ—è¡¨

```
src/components/ui/
â”œâ”€â”€ button.tsx
â”œâ”€â”€ card.tsx
â”œâ”€â”€ dialog.tsx
â”œâ”€â”€ dropdown-menu.tsx
â”œâ”€â”€ input.tsx
â”œâ”€â”€ label.tsx
â”œâ”€â”€ select.tsx
â”œâ”€â”€ tabs.tsx
â”œâ”€â”€ toast.tsx
â””â”€â”€ ...
```

### 11.3 ä¸»é¢˜

æ”¯æŒ Light/Dark æ¨¡å¼åˆ‡æ¢

```typescript
import { useTheme } from 'next-themes';
const { theme, setTheme } = useTheme();
```

---

## åäºŒã€çŠ¶æ€ç®¡ç†

### 12.1 å®¢æˆ·ç«¯çŠ¶æ€

ä½¿ç”¨ Zustand

```typescript
import { create } from 'zustand';

const useStore = create((set) => ({
  count: 0,
  increment: () => set((state) => ({ count: state.count + 1 })),
}));
```

### 12.2 æœåŠ¡ç«¯çŠ¶æ€

ä½¿ç”¨ React Queryï¼ˆTanStack Queryï¼‰

```typescript
import { useQuery } from '@tanstack/react-query';

const { data, isLoading } = useQuery({
  queryKey: ['projects'],
  queryFn: () => getUserProjectsAction(),
});
```

---

## åä¸‰ã€Server Actions

### 13.1 å®‰å…¨åŒ…è£…

ä½¿ç”¨ next-safe-action åŒ…è£…

```typescript
// src/lib/safe-action.ts
import { createSafeActionClient } from 'next-safe-action';

export const publicActionClient = createSafeActionClient();

export const userActionClient = createSafeActionClient()
  .use(authMiddleware);

export const adminActionClient = createSafeActionClient()
  .use(authMiddleware)
  .use(adminMiddleware);
```

### 13.2 ä½¿ç”¨æ–¹å¼

```typescript
// å®šä¹‰Action
export const createProjectAction = userActionClient
  .schema(createProjectSchema)
  .action(async ({ parsedInput, ctx }) => {
    // ctx.user æ˜¯å½“å‰ç”¨æˆ·
    return { success: true };
  });

// è°ƒç”¨Action
const result = await createProjectAction({ inputText });
if (result?.serverError) {
  // å¤„ç†é”™è¯¯
}
```

---

## åå››ã€éƒ¨ç½²æ–¹æ¡ˆ

### 14.1 Verceléƒ¨ç½²

```bash
# ç›´æ¥æ¨é€åˆ°GitHubï¼ŒVercelè‡ªåŠ¨éƒ¨ç½²
git push origin main
```

### 14.2 Cloudflareéƒ¨ç½²

```bash
pnpm preview  # æœ¬åœ°é¢„è§ˆ
pnpm deploy   # éƒ¨ç½²åˆ°Cloudflare
pnpm upload   # ä»…ä¸Šä¼ ä¸æ¿€æ´»
```

### 14.3 Dockeréƒ¨ç½²

å¯è‡ªè¡Œç¼–å†™Dockerfile

---

## åäº”ã€å¼€å‘å·¥å…·

### 15.1 ä»£ç è§„èŒƒ

- Biomeï¼ˆæ›¿ä»£ESLint + Prettierï¼‰

```bash
pnpm lint    # æ£€æŸ¥å¹¶ä¿®å¤
pnpm format  # æ ¼å¼åŒ–
```

### 15.2 ä¾èµ–åˆ†æ

- Knipï¼ˆæœªä½¿ç”¨ä¾èµ–æ£€æµ‹ï¼‰

```bash
pnpm knip
```

### 15.3 é‚®ä»¶é¢„è§ˆ

```bash
pnpm email  # æ‰“å¼€é‚®ä»¶é¢„è§ˆæœåŠ¡å™¨
```

---

## åå…­ã€è„šæ‰‹æ¶åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| ç”¨æˆ·è®¤è¯ | âœ… | Better Auth |
| OAuthç™»å½• | âœ… | Google/GitHub |
| é‚®ç®±éªŒè¯ | âœ… | Resend |
| å¯†ç é‡ç½® | âœ… | Resend |
| ç”¨æˆ·ç®¡ç† | âœ… | ç®¡ç†åå° |
| è®¢é˜…æ”¯ä»˜ | âœ… | Stripe/Creem |
| ä¸€æ¬¡æ€§æ”¯ä»˜ | âœ… | Stripe/Creem |
| ç§¯åˆ†ç³»ç»Ÿ | âœ… | FIFOæ¶ˆè´¹ |
| ç§¯åˆ†åŒ… | âœ… | å¯è´­ä¹° |
| å…‘æ¢ç  | âœ… | æ‰¹é‡ç”Ÿæˆ |
| åšå®¢ç³»ç»Ÿ | âœ… | Fumadocs MDX |
| æ–‡æ¡£ç³»ç»Ÿ | âœ… | Fumadocs MDX |
| å›½é™…åŒ– | âœ… | next-intl |
| æ·±è‰²æ¨¡å¼ | âœ… | next-themes |
| é‚®ä»¶å‘é€ | âœ… | Resend |
| æ–‡ä»¶å­˜å‚¨ | âœ… | S3å…¼å®¹ |
| ç®¡ç†åå° | âœ… | RBAC |
| åˆ†æç»Ÿè®¡ | âœ… | GA/PostHog |
| Newsletter | âœ… | Resend |
| å®¢æœèŠå¤© | âœ… | Crisp |
| éªŒè¯ç  | âœ… | Turnstile |

---

## åä¸ƒã€æ€§èƒ½ä¼˜åŒ–

### 17.1 å·²å®æ–½ä¼˜åŒ–

1. **N+1æŸ¥è¯¢ä¼˜åŒ–**ï¼šä½¿ç”¨`inArray`æ‰¹é‡æŸ¥è¯¢
2. **å¹¶è¡Œå›¾åƒç”Ÿæˆ**ï¼šå¹¶å‘æ•°é™åˆ¶ä¸º2
3. **æŒ‡æ•°é€€é¿è½®è¯¢**ï¼š1sâ†’5sè‡ªé€‚åº”
4. **ä¾èµ–æ¸…ç†**ï¼šç§»é™¤æœªä½¿ç”¨ä¾èµ–

### 17.2 å»ºè®®ä¼˜åŒ–

1. **SSEæ›¿ä»£è½®è¯¢**ï¼šå®æ—¶æ¨é€ç”Ÿæˆè¿›åº¦
2. **å›¾ç‰‡CDN**ï¼šä½¿ç”¨CDNåŠ é€Ÿå›¾ç‰‡åŠ è½½
3. **è¾¹ç¼˜ç¼“å­˜**ï¼šä½¿ç”¨Edge Runtimeç¼“å­˜é™æ€å†…å®¹
4. **é˜Ÿåˆ—ç³»ç»Ÿ**ï¼šä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†å¤§é‡ç”Ÿæˆä»»åŠ¡
